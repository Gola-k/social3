{"ast":null,"code":"var _jsxFileName = \"/Users/siddharthpranay/Desktop/projects/Chirping/frontend/src/components/Signin.js\",\n  _s = $RefreshSig$();\nimport { useNavigate } from \"react-router-dom\";\nimport { useAccount, useConnect, useSignMessage, useDisconnect } from \"wagmi\";\nimport { injected } from \"wagmi/connectors\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function SignIn() {\n  _s();\n  const navigate = useNavigate();\n  const {\n    connectAsync\n  } = useConnect();\n  const {\n    disconnectAsync\n  } = useDisconnect();\n  const {\n    isConnected\n  } = useAccount();\n  const {\n    signMessageAsync\n  } = useSignMessage();\n  const ServerUrl = \"http://localhost:4000\";\n  const handleAuth = async () => {\n    //disconnects the web3 provider if it's already active\n    if (isConnected) {\n      await disconnectAsync();\n    }\n    // enabling the web3 provider metamask\n    const {\n      account\n    } = await connectAsync({\n      connector: new injected({\n        target: 'metaMask'\n      })\n    });\n    const userData = {\n      address: account,\n      chain: 97\n    };\n    // making a post request to our 'request-message' endpoint\n    const {\n      data\n    } = await axios.post(`${ServerUrl}/request-message`, userData, {\n      headers: {\n        \"content-type\": \"application/json\"\n      }\n    });\n    const message = data.message;\n    // signing the received message via metamask\n    const signature = await signMessageAsync({\n      message\n    });\n    await axios.post(`${ServerUrl}/verify`, {\n      message,\n      signature\n    }, {\n      withCredentials: true\n    } // set cookie from Express server\n    );\n\n    // redirect to /user\n    navigate(\"/user\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Web3 Authentication\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => handleAuth(),\n      children: \"Authenticate via MetaMask\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n_s(SignIn, \"JrFjZMKci5C17atZS0viSvKtjDA=\", false, function () {\n  return [useNavigate, useConnect, useDisconnect, useAccount, useSignMessage];\n});\n_c = SignIn;\nvar _c;\n$RefreshReg$(_c, \"SignIn\");","map":{"version":3,"names":["useNavigate","useAccount","useConnect","useSignMessage","useDisconnect","injected","axios","jsxDEV","_jsxDEV","SignIn","_s","navigate","connectAsync","disconnectAsync","isConnected","signMessageAsync","ServerUrl","handleAuth","account","connector","target","userData","address","chain","data","post","headers","message","signature","withCredentials","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","_c","$RefreshReg$"],"sources":["/Users/siddharthpranay/Desktop/projects/Chirping/frontend/src/components/Signin.js"],"sourcesContent":["import { useNavigate } from \"react-router-dom\";\n\nimport { useAccount, useConnect, useSignMessage, useDisconnect } from \"wagmi\";\nimport { injected } from \"wagmi/connectors\";\nimport axios from \"axios\";\n\nexport default function SignIn() {\n  const navigate = useNavigate();\n\n  const { connectAsync } = useConnect();\n  const { disconnectAsync } = useDisconnect();\n  const { isConnected } = useAccount();\n  const { signMessageAsync } = useSignMessage();\n\n  const ServerUrl = \"http://localhost:4000\";\n\n  const handleAuth = async () => {\n    //disconnects the web3 provider if it's already active\n    if (isConnected) {\n      await disconnectAsync();\n    }\n    // enabling the web3 provider metamask\n    const { account } = await connectAsync({\n      connector: new injected({ target: 'metaMask'}),\n    });\n\n    const userData = { address: account, chain: 97 };\n    // making a post request to our 'request-message' endpoint\n    const { data } = await axios.post(\n      `${ServerUrl}/request-message`,\n      userData,\n      {\n        headers: {\n          \"content-type\": \"application/json\",\n        },\n      }\n    );\n    const message = data.message;\n    // signing the received message via metamask\n    const signature = await signMessageAsync({ message });\n\n    await axios.post(\n      `${ServerUrl}/verify`,\n      {\n        message,\n        signature,\n      },\n      { withCredentials: true } // set cookie from Express server\n    );\n\n    // redirect to /user\n    navigate(\"/user\");\n  };\n\n  return (\n    <div>\n      <h3>Web3 Authentication</h3>\n      <button onClick={() => handleAuth()}>Authenticate via MetaMask</button>\n    </div>\n  );\n}"],"mappings":";;AAAA,SAASA,WAAW,QAAQ,kBAAkB;AAE9C,SAASC,UAAU,EAAEC,UAAU,EAAEC,cAAc,EAAEC,aAAa,QAAQ,OAAO;AAC7E,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,OAAOC,KAAK,MAAM,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1B,eAAe,SAASC,MAAMA,CAAA,EAAG;EAAAC,EAAA;EAC/B,MAAMC,QAAQ,GAAGX,WAAW,CAAC,CAAC;EAE9B,MAAM;IAAEY;EAAa,CAAC,GAAGV,UAAU,CAAC,CAAC;EACrC,MAAM;IAAEW;EAAgB,CAAC,GAAGT,aAAa,CAAC,CAAC;EAC3C,MAAM;IAAEU;EAAY,CAAC,GAAGb,UAAU,CAAC,CAAC;EACpC,MAAM;IAAEc;EAAiB,CAAC,GAAGZ,cAAc,CAAC,CAAC;EAE7C,MAAMa,SAAS,GAAG,uBAAuB;EAEzC,MAAMC,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7B;IACA,IAAIH,WAAW,EAAE;MACf,MAAMD,eAAe,CAAC,CAAC;IACzB;IACA;IACA,MAAM;MAAEK;IAAQ,CAAC,GAAG,MAAMN,YAAY,CAAC;MACrCO,SAAS,EAAE,IAAId,QAAQ,CAAC;QAAEe,MAAM,EAAE;MAAU,CAAC;IAC/C,CAAC,CAAC;IAEF,MAAMC,QAAQ,GAAG;MAAEC,OAAO,EAAEJ,OAAO;MAAEK,KAAK,EAAE;IAAG,CAAC;IAChD;IACA,MAAM;MAAEC;IAAK,CAAC,GAAG,MAAMlB,KAAK,CAACmB,IAAI,CAC/B,GAAGT,SAAS,kBAAkB,EAC9BK,QAAQ,EACR;MACEK,OAAO,EAAE;QACP,cAAc,EAAE;MAClB;IACF,CACF,CAAC;IACD,MAAMC,OAAO,GAAGH,IAAI,CAACG,OAAO;IAC5B;IACA,MAAMC,SAAS,GAAG,MAAMb,gBAAgB,CAAC;MAAEY;IAAQ,CAAC,CAAC;IAErD,MAAMrB,KAAK,CAACmB,IAAI,CACd,GAAGT,SAAS,SAAS,EACrB;MACEW,OAAO;MACPC;IACF,CAAC,EACD;MAAEC,eAAe,EAAE;IAAK,CAAC,CAAC;IAC5B,CAAC;;IAED;IACAlB,QAAQ,CAAC,OAAO,CAAC;EACnB,CAAC;EAED,oBACEH,OAAA;IAAAsB,QAAA,gBACEtB,OAAA;MAAAsB,QAAA,EAAI;IAAmB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAC5B1B,OAAA;MAAQ2B,OAAO,EAAEA,CAAA,KAAMlB,UAAU,CAAC,CAAE;MAAAa,QAAA,EAAC;IAAyB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACpE,CAAC;AAEV;AAACxB,EAAA,CAtDuBD,MAAM;EAAA,QACXT,WAAW,EAEHE,UAAU,EACPE,aAAa,EACjBH,UAAU,EACLE,cAAc;AAAA;AAAAiC,EAAA,GANrB3B,MAAM;AAAA,IAAA2B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}