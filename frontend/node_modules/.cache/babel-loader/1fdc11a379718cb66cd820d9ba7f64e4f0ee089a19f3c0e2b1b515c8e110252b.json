{"ast":null,"code":"var _jsxFileName = \"/Users/siddharthpranay/Desktop/projects/Chirping/frontend/src/components/Signin.js\",\n  _s = $RefreshSig$();\nimport { useNavigate } from \"react-router-dom\";\nimport { useAccount, useConnect, useSignMessage, useDisconnect } from \"wagmi\";\nimport { injected } from \"wagmi/connectors\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function SignIn() {\n  _s();\n  const navigate = useNavigate();\n  const {\n    connectAsync\n  } = useConnect();\n  const {\n    disconnectAsync\n  } = useDisconnect();\n  const {\n    isConnected\n  } = useAccount();\n  const {\n    signMessageAsync\n  } = useSignMessage();\n  const ServerUrl = \"http://localhost:4000\";\n  const handleAuth = async () => {\n    //disconnects the web3 provider if it's already active\n    console.log(\"isconnected\", isConnected);\n    if (isConnected) {\n      await disconnectAsync();\n    }\n    // enabling the web3 provider metamask\n    const res = await connectAsync({\n      connector: injected({\n        target: 'metaMask'\n      })\n    });\n    const {\n      accounts,\n      chainId\n    } = res;\n    const userData = {\n      address: accounts[0],\n      chain: chainId\n    };\n    console.log(userData);\n    // making a post request to our 'request-message' endpoint\n    const {\n      data\n    } = await axios.post(`${ServerUrl}/request-message`, userData, {\n      headers: {\n        \"content-type\": \"application/json\"\n      }\n    });\n    const message = data.message;\n    // signing the received message via metamask\n    const signature = await signMessageAsync({\n      message\n    });\n    await axios.post(`${ServerUrl}/verify`, {\n      message,\n      signature\n    }, {\n      withCredentials: true\n    } // set cookie from Express server\n    );\n\n    // redirect to /user\n    navigate(\"/user\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Web3 Authentication\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => handleAuth(),\n      children: \"Authenticate via MetaMask\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 5\n  }, this);\n}\n_s(SignIn, \"JrFjZMKci5C17atZS0viSvKtjDA=\", false, function () {\n  return [useNavigate, useConnect, useDisconnect, useAccount, useSignMessage];\n});\n_c = SignIn;\nvar _c;\n$RefreshReg$(_c, \"SignIn\");","map":{"version":3,"names":["useNavigate","useAccount","useConnect","useSignMessage","useDisconnect","injected","axios","jsxDEV","_jsxDEV","SignIn","_s","navigate","connectAsync","disconnectAsync","isConnected","signMessageAsync","ServerUrl","handleAuth","console","log","res","connector","target","accounts","chainId","userData","address","chain","data","post","headers","message","signature","withCredentials","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","_c","$RefreshReg$"],"sources":["/Users/siddharthpranay/Desktop/projects/Chirping/frontend/src/components/Signin.js"],"sourcesContent":["import { useNavigate } from \"react-router-dom\";\n\nimport { useAccount, useConnect, useSignMessage, useDisconnect } from \"wagmi\";\nimport { injected } from \"wagmi/connectors\";\nimport axios from \"axios\";\n\nexport default function SignIn() {\n  const navigate = useNavigate();\n\n  const { connectAsync } = useConnect();\n  const { disconnectAsync } = useDisconnect();\n  const { isConnected } = useAccount();\n  const { signMessageAsync } = useSignMessage();\n\n  const ServerUrl = \"http://localhost:4000\";\n\n  const handleAuth = async () => {\n    //disconnects the web3 provider if it's already active\n    console.log(\"isconnected\", isConnected);\n    if (isConnected) {\n      await disconnectAsync();\n    }\n    // enabling the web3 provider metamask\n    const res = await connectAsync({\n      connector: injected({ target: 'metaMask'}),\n    });\n\n    const { accounts, chainId } = res;\n\n    const userData = { address: accounts[0], chain: chainId };\n\n    console.log(userData);\n    // making a post request to our 'request-message' endpoint\n    const { data } = await axios.post(\n      `${ServerUrl}/request-message`,\n      userData,\n      {\n        headers: {\n          \"content-type\": \"application/json\",\n        },\n      }\n    );\n    const message = data.message;\n    // signing the received message via metamask\n    const signature = await signMessageAsync({ message });\n\n    await axios.post(\n      `${ServerUrl}/verify`,\n      {\n        message,\n        signature,\n      },\n      { withCredentials: true } // set cookie from Express server\n    );\n\n    // redirect to /user\n    navigate(\"/user\");\n  };\n\n  return (\n    <div>\n      <h3>Web3 Authentication</h3>\n      <button onClick={() => handleAuth()}>Authenticate via MetaMask</button>\n    </div>\n  );\n}"],"mappings":";;AAAA,SAASA,WAAW,QAAQ,kBAAkB;AAE9C,SAASC,UAAU,EAAEC,UAAU,EAAEC,cAAc,EAAEC,aAAa,QAAQ,OAAO;AAC7E,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,OAAOC,KAAK,MAAM,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1B,eAAe,SAASC,MAAMA,CAAA,EAAG;EAAAC,EAAA;EAC/B,MAAMC,QAAQ,GAAGX,WAAW,CAAC,CAAC;EAE9B,MAAM;IAAEY;EAAa,CAAC,GAAGV,UAAU,CAAC,CAAC;EACrC,MAAM;IAAEW;EAAgB,CAAC,GAAGT,aAAa,CAAC,CAAC;EAC3C,MAAM;IAAEU;EAAY,CAAC,GAAGb,UAAU,CAAC,CAAC;EACpC,MAAM;IAAEc;EAAiB,CAAC,GAAGZ,cAAc,CAAC,CAAC;EAE7C,MAAMa,SAAS,GAAG,uBAAuB;EAEzC,MAAMC,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7B;IACAC,OAAO,CAACC,GAAG,CAAC,aAAa,EAAEL,WAAW,CAAC;IACvC,IAAIA,WAAW,EAAE;MACf,MAAMD,eAAe,CAAC,CAAC;IACzB;IACA;IACA,MAAMO,GAAG,GAAG,MAAMR,YAAY,CAAC;MAC7BS,SAAS,EAAEhB,QAAQ,CAAC;QAAEiB,MAAM,EAAE;MAAU,CAAC;IAC3C,CAAC,CAAC;IAEF,MAAM;MAAEC,QAAQ;MAAEC;IAAQ,CAAC,GAAGJ,GAAG;IAEjC,MAAMK,QAAQ,GAAG;MAAEC,OAAO,EAAEH,QAAQ,CAAC,CAAC,CAAC;MAAEI,KAAK,EAAEH;IAAQ,CAAC;IAEzDN,OAAO,CAACC,GAAG,CAACM,QAAQ,CAAC;IACrB;IACA,MAAM;MAAEG;IAAK,CAAC,GAAG,MAAMtB,KAAK,CAACuB,IAAI,CAC/B,GAAGb,SAAS,kBAAkB,EAC9BS,QAAQ,EACR;MACEK,OAAO,EAAE;QACP,cAAc,EAAE;MAClB;IACF,CACF,CAAC;IACD,MAAMC,OAAO,GAAGH,IAAI,CAACG,OAAO;IAC5B;IACA,MAAMC,SAAS,GAAG,MAAMjB,gBAAgB,CAAC;MAAEgB;IAAQ,CAAC,CAAC;IAErD,MAAMzB,KAAK,CAACuB,IAAI,CACd,GAAGb,SAAS,SAAS,EACrB;MACEe,OAAO;MACPC;IACF,CAAC,EACD;MAAEC,eAAe,EAAE;IAAK,CAAC,CAAC;IAC5B,CAAC;;IAED;IACAtB,QAAQ,CAAC,OAAO,CAAC;EACnB,CAAC;EAED,oBACEH,OAAA;IAAA0B,QAAA,gBACE1B,OAAA;MAAA0B,QAAA,EAAI;IAAmB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAC5B9B,OAAA;MAAQ+B,OAAO,EAAEA,CAAA,KAAMtB,UAAU,CAAC,CAAE;MAAAiB,QAAA,EAAC;IAAyB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACpE,CAAC;AAEV;AAAC5B,EAAA,CA3DuBD,MAAM;EAAA,QACXT,WAAW,EAEHE,UAAU,EACPE,aAAa,EACjBH,UAAU,EACLE,cAAc;AAAA;AAAAqC,EAAA,GANrB/B,MAAM;AAAA,IAAA+B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}